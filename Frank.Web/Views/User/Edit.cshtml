
@{
	ViewBag.Title = "Edit";
	Layout = "~/Views/Shared/_LayoutAdmin.cshtml";
}

@using Frank.Model.Entities;
@model User
<style>
	.table td {
		width: 50%;
	}
</style>

@using (Ajax.BeginForm("Edit", "User", new AjaxOptions
{
	HttpMethod = "PUT",
	OnFailure = "AjaxFormError",
	OnSuccess = "AjaxFormSuccess",
}, new { enctype = "multipart/form-data" }))
{
	@Html.AntiForgeryToken()
	<table class="table" style="width:700px;margin:auto">
		<tbody>
			<h2 style="text-align:center">Chỉnh sửa tài khoản</h2>
			<hr />
			<tr>
				<td colspan="2">
					<input type="number" class="form-control" style="display:none" id="Id" name="Id" value="@Model.Id">
				</td>
			</tr>
			<tr>
				<td>
					<label for="UserName" class="form-label">Tên tài khoản</label>
					<input type="text" class="form-control" id="UserName" name="UserName"  value="@Model.UserName" required>
				</td>
				<td>
					<label for="Password" class="form-label">Mật khẩu</label>
					<input type="text" class="form-control" id="Password" name="Password" value="@Model.Password" required>
				</td>
			</tr>
			<tr>
				<td>
					<label for="FullName" class="form-label">Họ và tên chủ tài khoản</label>
					<input type="text" class="form-control" id="FullName" name="FullName" value="@Model.FullName" required>
				</td>
				<td>
					<label for="Email" class="form-label">Email</label>
					<input type="email" class="form-control" id="Email" name="Email" value="@Model.Email" required>
				</td>
			</tr>
			<tr>
				<td>
					<label for="Address" class="form-label">Địa chỉ</label>
					<input type="text" class="form-control" id="Address" name="Address" value="@Model.Address" required>
				</td>
				<td>
					<label for="PhoneNumber" class="form-label">Số điện thoại</label>
					<input type="number" class="form-control" id="PhoneNumber" name="PhoneNumber" value="@Model.PhoneNumber" required>
				</td>
			</tr>
			<tr>
				<td>
					<label for="Status" class="form-label">Trạng thái</label>

					@Html.DropDownList("Status", (IEnumerable<SelectListItem>)ViewBag.Status, new { @class = "form-control" })
				<td>
					<label for="Status" class="form-label">Quyền của tài khoản</label>
					@Html.DropDownList("Quyen", (IEnumerable<SelectListItem>)ViewBag.quyen, new { @class = "form-control" })
				</td>
				</td>
			</tr>
					
			<tr>
				<td colspan="2" style="text-align:center; margin-top:10px;">
					<button type="submit" id="submitedituser" class="tox-button" style="text-align:center;color:white;background-color:blue">Xác nhận</button>
				</td>
			</tr>
		</tbody>
	</table>
}
<link rel="stylesheet" href="~/Content/toastr.min.css" />
<script src="~/Scripts/toastr.min.js"></script>
<script src="~/Scripts/jquery-3.6.0.min.js"></script>
<script>
	$(document).ready(function () {
		$('#ProductImage').change(function () {
			readURL(this);
			$("#check").hide();
		});

		function readURL(input) {
			if (input.files && input.files[0]) {
				var reader = new FileReader();

				reader.onload = function (e) {
					$('#imagePreview').attr('src', e.target.result);
					$('#imagePreview').show();
				}

				reader.readAsDataURL(input.files[0]);
			}
		}

		$("#submitedituser").click(function (event) {
			var PhoneNumber = $("#PhoneNumber").val();
			var regex = /^\d{10}$/;
			if (!regex.test(PhoneNumber)) {
				event.preventDefault(); // Ngăn chặn việc submit form nếu input không hợp lệ
				toastr.error("Vui lòng nhập số điện thoại đúng định dạng", "Thông báo");
			}
		});
	});
</script>
<script>
	function AjaxFormError() {
		toastr.error("Có lỗi xảy ra trong quá trình gửi yêu cầu", "Lỗi");
	}
	function AjaxFormSuccess(rs) {
		if (rs.Status) {
			toastr.success(rs.Message, "Thông báo");
			setTimeout(function() {
            window.location.href = '@Url.Action("Index", "User")';
        }, 1000);
		} else {
			toastr.error(rs.Message, "Thông báo");
		}
	}
</script>


